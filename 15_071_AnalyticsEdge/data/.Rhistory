install.packages("tm")
install.packages("SnowballC")
library(tm) # Will use to create corpus and modify text therein.
library(SnowballC) # Will use for "stemming."
library(rpart) # Will use to construct a CART model.
library(rpart.plot) # Will use to plot CART tree.
setwd("Users/yukako/WorkSpace/LearnML/15_071_AnalyticsEdge/data/)
setwd("Users/yukako/WorkSpace/LearnML/15_071_AnalyticsEdge/data/")
Weekly = read.csv("WeeklyMoisturizerSales.csv")
setwd("Users/yukako/WorkSpace/LearnML/15_071_AnalyticsEdge/data/")
setwd("/Users/yukako/WorkSpace/LearnML/15_071_AnalyticsEdge/data/")
Weekly = read.csv("WeeklyMoisturizerSales.csv")
str(Weekly)
############################
#Q1.a
############################
# Plot the variable MoisturizerSales versus time
Weekly$Date <- as.Date(strptime(Weekly$Date, "%Y-%m-%d"))
str(Weekly)
plot(Weekly$MoisturizerSales~Weekly$Date)
plot(Weekly$MoisturizerSales~Weekly$Month)
############################
#Q1.b
############################
# Plot the variable GoogleTrendVolumeEczema versus time
plot(Weekly$GoogleTrendVolumeEczema~Weekly$Date)
plot(Weekly$GoogleTrendVolumeEczema~Weekly$Month)
############################
#Q2
############################
# We need to create a lag variable for Sales. We can create a lag variable
# called SalesYesterday as follows.
Weekly$MoisturizerSalesPreweek = c(NA, head(Weekly$MoisturizerSales, -1))
Weekly$GoogleTrendVolumeEczemaPreweek = c(NA, head(Weekly$GoogleTrendVolumeEczema, -1))
# Let us take a look.
str(Weekly)
#Training/test split.
training = subset(Weekly, as.Date(Date) <= as.Date("2013-06-30"))
testing = subset(Weekly, as.Date(Date) > as.Date("2013-06-30"))
# Model with one lag variable:
model1 = lm(MoisturizerSales~ MoisturizerSalesPreweek, data=training)
summary(model1)
RSS <- c(crossprod(model1$residuals))
MSE <- RSS / length(model1$residuals)
RMSE <- sqrt(MSE)
RMSE
# Model with one lag variable + Month:
model2 = lm(MoisturizerSales~ MoisturizerSalesPreweek + Month, data=training)
summary(model2)
RSS2 <- c(crossprod(model2$residuals))
MSE2 <- RSS2 / length(model2$residuals)
RMSE2 <- sqrt(MSE2)
RMSE2
# Model with one GoogleTrendVolumeEczemaPreweek + Month:
model3 = lm(MoisturizerSales~ GoogleTrendVolumeEczemaPreweek + Month, data=training)
summary(model3)
RSS3 <- c(crossprod(model3$residuals))
MSE3 <- RSS3 / length(model3$residuals)
RMSE3 <- sqrt(MSE3)
RMSE3
model3.predtest = predict(model3, newdata=testing)
SSETest3= sum((model3.predtest - testing$MoisturizerSales)^2)
train.mean = mean(training$MoisturizerSales)
SSTTest = sum((testing$MoisturizerSales - train.mean)^2)
MSE4=SSETest3/nrow(testing)
RMSE4=sqrt(MSE4)
RMSE4
OSR2 = 1 - SSETest3/SSTTest
# The Out of Sample Rsquared
OSR2
summary(model1)
str(Weekly)
head(Weekly)
plot(Weekly$MoisturizerSales, Weekly$GoogleTrendVolumeEczema)
plot(Weekly$MoisturizerSalesPreweek, Weekly$GoogleTrendVolumeEczema)
plot(Weekly$MoisturizerSales, Weekly$GoogleTrendVolumeEczema)
plot(Weekly$MoisturizerSalesPreweek, Weekly$GoogleTrendVolumeEczema)
plot(Weekly$MoisturizerSales, Weekly$GoogleTrendVolumeEczemaPreweek)
plot(Weekly$MoisturizerSalesPreweek, Weekly$GoogleTrendVolumeEczemaPreweek)
summary(model3)
